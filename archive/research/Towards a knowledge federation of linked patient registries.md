# Towards a knowledge federation of linked patient registries

**Abstract**

Rare disease patient registries are now an essential tool for all clinical stakeholders. These systems’ features aim to improve patient treatments by collecting comprehensive electronic patient records. Understanding these data is a vital step towards personalized medicine. Yet, the growing number of disease-specific patient registries brings new challenges for life sciences researchers. These systems are closed data silos, with independent formats and data models. As they were built with security and privacy in mind, available tools lack comprehensive data access mechanisms, thus making data sharing a complex process. However, exchanging knowledge is essential to a better understanding of studied diseases. To tackle these challenges we introduce a semantic web-based architecture to connect distributed and heterogeneous registries. This enables the federation of knowledge between multiple independent environments. The semantic web paradigm enhances the ways we deal with data, optimising how we can create, infer and publish knowledge. Hence, we adopt these modern standards to deploy patient registry add ons. These can extract anonymised data and elevate them to a knowledge-oriented format, common to all registries. The outcome is a unique semantic layer, connecting miscellaneous registries, which we access using federated querying. Ultimately, this strategy empowers an holistic view through connected registries, enabling state-of-the-art semantic data sharing and access.

## Introduction

Current research asserts that a rare disease is a particular condition affecting at most 1 in 2000 patients. The European Organization for Rare Diseases (EURORDIS) estimates that there are approximately 6000 to 8000 rare diseases, affecting about 6% to 8% of the population. From these, about 80% have a genetic origin. Still, personal health implications behind rare diseases are seldom considered in medical care. These diseases have a low incidence rate and their complex treatment process makes their research an underrated field in the life sciences. At the patient level, it is difficult to find support, both at clinical and psychological level [1](), due to the reduced incidence of each individual disease. The existence of a small number of patients for each rare disease also delays the creation of adequate research studies as it is difficult to identify and coordinate a proper cohort [2,3](). Nevertheless, we cannot ignore the value behind studying rare diseases. Despite the low statistic impact on these diseases, the combined amount of patients suffering from similar diseases is considerably high. During the last decade, niche databases for the domains of neurological disorders [11]() or muscular problems [12](), for example, were developed tackle research on small specific sub-groups. While they provide high quality information and resources, their disease coverage is small and inadequate. This requires the creation of virtual cohorts of patients with similar features spread worldwide. Moreover, it is in these particular conditions that the strongest relations between genotypes and phenotypes are identified. 
In addition to long-term patient care improvements, understanding gene-disease associations is a fundamental goal for bioinformatics research, especially at the rare disease level, where genotype-phenotype connections are typically limited to one or a few more genes. Hence, to fully understand the underlying causes of diseases, we need to connect knowledge that is widespread throughout miscellaneous registries. These are closed data silos with independent data models and relying on primitive formats. This is further hindered by the fact that there is a clear difficulty in finding the adequate ontologies to map internal data from patient registries to an external shared common language. The outcome of this is a lack of interest in sharing data, further locking the potential behind collected data. Hence, we need not only the proper tools to extract information from these databases, but also a common shared model to where available knowledge can be mapped. 
In this work we introduce edge-of-breed software engineering strategies to provide a seamless working environment for everyone involved in rare disease research. Our goal is to deploy a semantic web layer on top of existing patient registries. With this add on, we will extract anonymised data from the registries, translate them to a common shared exchange model and make them available to the research community.
This solution address three key requirements from the patient registries research community: 1) model agnostic; 2) distributed and independent; 3) knowledge-oriented.
First, created strategies must be model agnostic and work regardless of registries’ data format and internal structure. This is clearly important as we are dealing with systems featuring assorted characteristics. Although there are modern registries with relational databases and service endpoints, we also encounter registries stored in single Excel spreadsheets. This should not be an obstruction to integrating registries into the semantic knowledge layer. Next, the deployed solution must be distributed and independent. When dealing with rare disease patients, it is imperative to consider data anonymity and privacy. 
 Hence, we must develop tools that extract meaningful data while maintaining the original patients’ metadata hidden. Likewise, we must also ensure that the new system works without changing the original patient registries. The entropy of adding this new component to existing systems must be as minimal as possible. 
At last, the new system must take advantage of semantic web technologies to extract the true added value of connected knowledge. The semantic web paradigm brings unique standards to improve how we access, express and share knowledge. 
From a technological perspective, this system will be built on top of COEUS (refs). COEUS is a semantic web application framework designed to streamline the  creation of semantic web-oriented systems. Using these technologies will allow researchers to explore the true meaning of their data as all integrated systems will be seen as a unique virtual patient registry.
In summary, we believe that exploring semantic web technologies to empower a non-intrusive approach is an innovative approach to connect, enrich and federate knowledge from patient registries.


## Background

### Rare disease patient registries

Personal genetic records are of growing importance for diagnosis and resolution of rare diseases. This took medicine to a level where wet-lab research is crucial to unravel disease causes and consequences. Hence, databases emerging with information about human genome, such as the HGMD (Human Gene Mutation Database) [4]() or the 1000 Genomes Project [5]() have a growing relevance. It is important to collect their public data in novel biomedical software, enabling its usage on the daily medical workflow. Despite being essential in life sciences research, personalised medicine requires the knowledge from entirely distinct datasets: electronic patient records.
The de facto standard in rare diseases software is Orphanet [7](), a web platform directed to the general public, health professionals and patients, to inform about orphan drugs and rare diseases. It also displays information on specialized consultations, diagnostics, research projects, clinical trials and support groups. Diseasecard [8]() is another portal aggregating information regarding rare diseases and pointing to key elements for both the education and the biomedical research field.
Along with these applications, we must take in account EHRs, gathered from miscellaneous health information systems, containing clinically relevant patient information. Data from sequence mutations, genes and drug interactions – the genotype – must be combined with data from electronic health records (EHR), DICOM imaging and disease-specific patient data – the phenotype. Hence, we must start exploring patient-level data from rare diseases registries. These patient-centric databases offer unique specialised views over their internal datasets. However, while there are huge amounts data scattered throughout multiple stakeholders, they are wildly difficult to obtain. The outcome of this is that, in the end, there is not enough data to generate statically meaningful conclusions. As such, we cannot discover or infer new knowledge because there is no access to a minimal amount of patient data.
To cope with these challenges we need a platform that offers a unique holistic view promoting the collaboration of multiple entities towards the study of rare diseases and assessment of patients’ evolution. 



The Semantic Web arises as a groundbreaking paradigm to foster the intelligent integration of structured information. Sustained by state-of-the-art standards such as RDF , OWL, SPARQL and LinkedData, Semantic Web promotes better strategies to express, infer and make knowledge interoperable.
Latest advances in the area cover the research and development of new algorithms to further improve how we collect data, transform data into meaningful knowledge assertions, and publish connected knowledge. State-of-the-art solutions, including the EBI RDF Platform, COEUS or SADI, pave the way towards interoperable scientific knowledge. From a large-scale perspective, we can now see the Semantic Web as a single knowledge network. Available technologies foster data integration and publishing, enabling an effortless connection between heterogeneous distributed knowledge.
The true value behind Semantic Web technologies lies in on how easy it is to access and exchange knowledge between independent systems.
LinkedData guidelines promote accessing data via unique URIs that, besides identifying knowledge, must resolve to real data.
SPARQL, the Semantic Web query language, complements LinkedData. 
Knowledge bases with an open SPARQL endpoint enable direct queries to their content. This empowers researchers and developers alike with an open knowledge highway. In this area, COEUS will play a fundamental role. COEUS delivers a "Semantic Web in a box" approach, enabling the rapid development of new knowledge management systems adopting semantic web technologies [31, 32](). COEUS includes, by default, algorithms to discover knowledge from SPARQL endpoints or LinkedData interface. Likewise, it features algorithms to publish collected data via SPARQL endpoint or LinkedData interfaces. 
Hence, COEUS is at the core of our research project, where extracted data will be stored and connected to a worldwide semantic intelligent network. This will bring true added value to the patient registries research domain, as it will improve all processes associated with knowledge discovery and management, from data acquisition to LinkedData publishing, among others.



## Methods

Semantic data integration is, in itself, a complex data engineering issue [17](), and the personalised medicine field further increases this complexity [18](). To support this platform’s ambitious integration and interoperability features we rely on the COEUS framework [19](). Exploring COEUS flexible integration engine enabled us to simplify the overall platform architecture through the creation of a comprehensive dependency-based resource integration network.

### Architecture

Figure 1 highlights the platform’s distributed architecture, organised in four levels: 1) patient, semantic, federation and research.
At the patient level we encounter the distributed and heterogeneous patient registries. Patient registries can be stored using one standalone technology or a combination of various technologies simultaneously. Likewise, data are stored according to multiple formats. Although Figure 1 only features three rare diseases patient registries, this solution envisages the inclusion of any number of registries. Patient registries can be integrated regardless of their location, as long as an Internet connection is available.
At the second level we include additional semantics to patient registries data. This is done using COEUS, which acts as the main abstraction, storage and publishing engine.
The third level features the actual knowledge federation. With COEUS acting as a middleware component between the patient registry triplestore and the public knowledge federation layer. Queries to any SPARQL engine can be composed of connections to several similar patient registries endpoints. 
Hence, at the fourth level, researchers can perform general queries that combine data from one or more patient registries. In a sense, query federation enables performing SQL-like UNIONs or JOINs across multiple knowledge bases. This empowers knowledge inference and reasoning queries to go beyond what is currently possible.


### Workflow

Publishing patient registries data on the web requires a comprehensive workflow. For simplicity purposes, Figure 2 highlights the key points in the semantic integration and translation pipeline: 1) ontology mapping; 2) COEUS setup; 3) semantic translation and 4) data publishing.
The first step consists in defining the best ontologies to map common patients data. HPO (ref), UMLS (ref), ICD (ref) or Orphanet (ref) are the most widely ontologies in the rare diseases field. COEUS enables combining these ontologies in the same system. This enables a deeper and richer description of available data. For example, the same data element can be mapped to terms from more than one ontology, further optimising its expressiveness and how it can be used in future research environments.
The second step regards COEUS setup. In this stage we must configure and deploy a new COEUS instance. The setup involves defining how data will be extracted and mapped into the selected ontology terms. With COEUS’ flexible integration connectors, we just have to specify where the data comes from (Excel, CSV or XML files; SQL databases; or SPARQL/LinkedData endpoints), and how we will map it to the ontologies. For instance, for a patient registry available as a CSV file, we need to specify the file location and, for each mapped ontology term, the column  containing the actual data elements.
COEUS’ configuration enables the semantic translation process. At this stage, new individuals are created for the miscellaneous knowledge base elements and their data and object properties are created in real-time from the integrated data. This process elevates data in primitive formats to a new semantic abstraction level. This step is complete when all data are imported into a new COEUS triplestore, making it available for external use through the various data publishing endpoints. 
As mentioned in the previous architecture section, data publishing enables a knowledge federation layer through the SPARQL endpoint and LinkedData interface. With it, researchers can access distributed patient registries data via a unique entry point.

### Features

One of the main premises behind the creation of a new Diseasecard version lied in the need to better explore the powerful technologies pushed forward by the Semantic Web paradigm. With these, Diseasecard is able to construct a rich and comprehensive semantic knowledge base for rare genetic diseases. Its knowledge infrastructure extends the capabilities of the majority research platforms by making the collected knowledge interoperable and future-proof. 
With this knowledge network the door is open for inferring new relationships amongst connected resources and for reasoning over gathered data in search for previously uncovered connections. In the future, these methods can be used to enrich Diseasecard’s knowledge base with new annotations, and to federate knowledge discovery through multiple databases with the publicly available SPARQL endpoints.
It is equally important to note that the lightweight integrative approach adopted in Diseasecard re-uses existing ontologies to describe data. Consequently, data from the knowledge base is easier to integrate by third parties and to connect using LinkedData technologies.

**Semantic interoperability**
With Diseasecard's knowledge base built, several interoperability services are enabled by default. Hence, Diseasecard's access API includes two main data access alternatives: a SPARQL endpoint [38]() and a LinkedData interface [39](). These two options allow flexible output formats, thus facilitating the data integration from Diseasecard's platform in external applications. 
SPARQL is the most advanced query language available and enables distributed reasoning and inference, as well as combining Diseasecard's data with other federated SPARQL endpoints. 
The LinkedData interfaces provide quick access to all data for a given resource and the use of these resources, through their URIs, in any external context. The URI for accessing Huntington's disease data in Diseasecard's knowledge base is http://bioinformatics.ua.pt/diseasecard/resource/omim\_143100.

Another major concern for data owners regards the need for changes in their software. Traditionally, third parties developed patient registries and biobanks software. For this matter, our approach requires no changes in existing software. We propose the creation of an additional semantic data layer that acts as an external plugin to the existing systems. Although ontology mappings and data translations may be required, this is done outside existing tools.

The translation process is also a key challenge. Existing data, often in legacy closed formats and without a well-defined model, must be abstracted into a new semantic web-based environment. This is where tools like D2R, COEUS, … or … play an important role. These tools facilitate the translation process by providing automated means for converting datasets in legacy formats into triples, ready for integration in a global knowledge base.

## Conclusions

This work introduces a unique semantic web-based layer that moves us towards knowledge federation in patient registries ecosystems. This delivers a lightweight holistic perspective over the wealth of knowledge stemming from linked patient registries supported by the growing number of research projects.
Our results are significant in at least three major respects. 1) The use of a model agnostic system, which enables the mapping of patient registries’ data from any format to a common shared ontology. 2) The creation of an independent system that can be plugged into any existing patient registry without changing it. Among others, this enables the extract relevant data elements while maintaining patients’ data privacy and security. 3) The adoption of semantic web technologies to promote a better translation, interpretation and federation of knowledge acquired from linked patient registries datasets.
In summary, this solution enables performing distributed queries to a federated system of linked patient registries. As a result, researchers can access a broad set of patient registries just like they would access a single system. We believe this is a milestone towards semantic interoperable rare diseases knowledge and will brings us one step closer to personalised medicine.

